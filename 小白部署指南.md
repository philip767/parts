# ğŸš€ PARTSCONTROL å°ç™½éƒ¨ç½²æŒ‡å—

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. æœåŠ¡å™¨è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04 æˆ–æ›´é«˜ç‰ˆæœ¬
- **å†…å­˜**: è‡³å°‘ 2GB RAM
- **å­˜å‚¨**: è‡³å°‘ 10GB å¯ç”¨ç©ºé—´
- **ç½‘ç»œ**: æœ‰å…¬ç½‘IPåœ°å€

### 2. éœ€è¦å‡†å¤‡çš„ä¿¡æ¯
- æœåŠ¡å™¨IPåœ°å€
- æœåŠ¡å™¨ç™»å½•å¯†ç 
- ä¸€ä¸ªåŸŸåï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰

## ğŸ¯ ç¬¬ä¸€æ­¥ï¼šè¿æ¥æœåŠ¡å™¨

### 1.1 ä½¿ç”¨SSHè¿æ¥æœåŠ¡å™¨
```bash
# åœ¨æ‚¨çš„ç”µè„‘ä¸Šæ‰“å¼€ç»ˆç«¯æˆ–å‘½ä»¤æç¤ºç¬¦ï¼Œè¾“å…¥ï¼š
ssh root@æ‚¨çš„æœåŠ¡å™¨IPåœ°å€

# ä¾‹å¦‚ï¼š
ssh root@123.456.789.123
```

### 1.2 è¾“å…¥å¯†ç 
è¿æ¥åä¼šæç¤ºè¾“å…¥å¯†ç ï¼Œè¾“å…¥æ‚¨çš„æœåŠ¡å™¨å¯†ç ï¼ˆè¾“å…¥æ—¶ä¸ä¼šæ˜¾ç¤ºå­—ç¬¦ï¼‰

## ğŸ”§ ç¬¬äºŒæ­¥ï¼šå®‰è£…åŸºç¡€è½¯ä»¶

### 2.1 æ›´æ–°ç³»ç»Ÿ
```bash
# å¤åˆ¶ç²˜è´´ä»¥ä¸‹å‘½ä»¤ï¼š
sudo apt update && sudo apt upgrade -y
```

### 2.2 å®‰è£…Node.js
```bash
# å¤åˆ¶ç²˜è´´ä»¥ä¸‹å‘½ä»¤ï¼š
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs
```

### 2.3 å®‰è£…MySQL
```bash
# å¤åˆ¶ç²˜è´´ä»¥ä¸‹å‘½ä»¤ï¼š
sudo apt install mysql-server -y
sudo systemctl start mysql
sudo systemctl enable mysql
```

### 2.4 å®‰è£…Nginx
```bash
# å¤åˆ¶ç²˜è´´ä»¥ä¸‹å‘½ä»¤ï¼š
sudo apt install nginx -y
sudo systemctl start nginx
sudo systemctl enable nginx
```

### 2.5 å®‰è£…PM2
```bash
# å¤åˆ¶ç²˜è´´ä»¥ä¸‹å‘½ä»¤ï¼š
sudo npm install -g pm2
```

## ğŸ“ ç¬¬ä¸‰æ­¥ï¼šä¸Šä¼ é¡¹ç›®æ–‡ä»¶

### æ–¹æ³•1ï¼šä½¿ç”¨Gitï¼ˆæ¨èï¼‰
```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•
sudo mkdir -p /var/www/partcontrol
sudo chown $USER:$USER /var/www/partcontrol
cd /var/www/partcontrol

# å¦‚æœæ‚¨æœ‰Gitä»“åº“ï¼Œä½¿ç”¨ï¼š
git clone https://github.com/æ‚¨çš„ç”¨æˆ·å/PARTSCONTROL.git .
```

### æ–¹æ³•2ï¼šä½¿ç”¨æ–‡ä»¶ä¸Šä¼ å·¥å…·
1. åœ¨æ‚¨çš„ç”µè„‘ä¸Šä¸‹è½½å¹¶å®‰è£… **FileZilla** æˆ– **WinSCP**
2. ä½¿ç”¨è¿™äº›å·¥å…·å°†é¡¹ç›®æ–‡ä»¶å¤¹ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ `/var/www/partcontrol/` ç›®å½•

## âš™ï¸ ç¬¬å››æ­¥ï¼šé…ç½®æ•°æ®åº“

```bash
# å¤åˆ¶ç²˜è´´ä»¥ä¸‹å‘½ä»¤ï¼š
sudo mysql -e "CREATE DATABASE IF NOT EXISTS partcontrol CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"
sudo mysql -e "CREATE USER IF NOT EXISTS 'partcontrol'@'localhost' IDENTIFIED BY 'PartControl2024!';"
sudo mysql -e "GRANT ALL PRIVILEGES ON partcontrol.* TO 'partcontrol'@'localhost';"
sudo mysql -e "FLUSH PRIVILEGES;"
```

## ğŸ”§ ç¬¬äº”æ­¥ï¼šé…ç½®é¡¹ç›®

### 5.1 è¿›å…¥é¡¹ç›®ç›®å½•
```bash
cd /var/www/partcontrol
```

### 5.2 é…ç½®ç¯å¢ƒå˜é‡
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp env.example .env
```

### 5.3 å®‰è£…åç«¯ä¾èµ–
```bash
cd åç«¯
npm install
mkdir -p uploads logs
chmod 755 uploads logs
```

### 5.4 å®‰è£…å‰ç«¯ä¾èµ–
```bash
cd ../å‰ç«¯
npm install
npm run build
```

## ğŸŒ ç¬¬å…­æ­¥ï¼šé…ç½®Nginx

### 6.1 åˆ›å»ºNginxé…ç½®
```bash
# å¤åˆ¶ç²˜è´´ä»¥ä¸‹å‘½ä»¤ï¼š
sudo tee /etc/nginx/sites-available/partcontrol > /dev/null << 'EOF'
server {
    listen 80;
    server_name _;
    
    location / {
        root /var/www/partcontrol/å‰ç«¯/dist;
        try_files $uri $uri/ /index.html;
        index index.html;
    }
    
    location /api {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
    
    location /uploads {
        alias /var/www/partcontrol/åç«¯/uploads;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }
}
EOF
```

### 6.2 å¯ç”¨é…ç½®
```bash
# å¤åˆ¶ç²˜è´´ä»¥ä¸‹å‘½ä»¤ï¼š
sudo ln -sf /etc/nginx/sites-available/partcontrol /etc/nginx/sites-enabled/
sudo rm -f /etc/nginx/sites-enabled/default
sudo nginx -t
sudo systemctl restart nginx
```

## ğŸš€ ç¬¬ä¸ƒæ­¥ï¼šå¯åŠ¨æœåŠ¡

```bash
# å¤åˆ¶ç²˜è´´ä»¥ä¸‹å‘½ä»¤ï¼š
cd /var/www/partcontrol/åç«¯
pm2 start server.js --name "partcontrol-backend"
pm2 save
pm2 startup
```

## âœ… ç¬¬å…«æ­¥ï¼šéªŒè¯éƒ¨ç½²

### 8.1 æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
# æ£€æŸ¥åç«¯æœåŠ¡
pm2 status

# æ£€æŸ¥NginxæœåŠ¡
sudo systemctl status nginx

# æ£€æŸ¥MySQLæœåŠ¡
sudo systemctl status mysql
```

### 8.2 è®¿é—®åº”ç”¨
åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ï¼š`http://æ‚¨çš„æœåŠ¡å™¨IPåœ°å€`

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1ï¼šç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
sudo netstat -tlnp | grep :3000

# æ€æ­»è¿›ç¨‹ï¼ˆæ›¿æ¢<PID>ä¸ºå®é™…çš„è¿›ç¨‹IDï¼‰
sudo kill -9 <PID>
```

### é—®é¢˜2ï¼šæƒé™é—®é¢˜
```bash
# ä¿®å¤æ–‡ä»¶æƒé™
sudo chown -R www-data:www-data /var/www/partcontrol
sudo chmod -R 755 /var/www/partcontrol
```

### é—®é¢˜3ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥MySQLçŠ¶æ€
sudo systemctl status mysql

# é‡å¯MySQL
sudo systemctl restart mysql
```

### é—®é¢˜4ï¼šNginxé…ç½®é”™è¯¯
```bash
# æ£€æŸ¥Nginxé…ç½®
sudo nginx -t

# æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log
```

## ğŸ“Š éƒ¨ç½²ä¿¡æ¯

### é‡è¦ä¿¡æ¯
- **é¡¹ç›®è·¯å¾„**: `/var/www/partcontrol`
- **æ•°æ®åº“å**: `partcontrol`
- **æ•°æ®åº“ç”¨æˆ·**: `partcontrol`
- **æ•°æ®åº“å¯†ç **: `PartControl2024!`
- **åç«¯ç«¯å£**: `3000`
- **å‰ç«¯ç«¯å£**: `80`

### ç®¡ç†å‘½ä»¤
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
pm2 status

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
pm2 logs

# é‡å¯æœåŠ¡
pm2 restart partcontrol-backend

# åœæ­¢æœåŠ¡
pm2 stop partcontrol-backend

# å¯åŠ¨æœåŠ¡
pm2 start partcontrol-backend
```

## ğŸ”’ å®‰å…¨å»ºè®®

1. **ä¿®æ”¹é»˜è®¤å¯†ç **
   - æ•°æ®åº“å¯†ç 
   - æœåŠ¡å™¨ç™»å½•å¯†ç 

2. **é…ç½®é˜²ç«å¢™**
   ```bash
   sudo apt install ufw -y
   sudo ufw allow ssh
   sudo ufw allow 80
   sudo ufw allow 443
   sudo ufw enable
   ```

3. **ç”³è¯·SSLè¯ä¹¦**ï¼ˆå¦‚æœæœ‰åŸŸåï¼‰
   ```bash
   sudo apt install certbot python3-certbot-nginx -y
   sudo certbot --nginx -d æ‚¨çš„åŸŸå.com
   ```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥é”™è¯¯æ—¥å¿—ï¼š`pm2 logs`
2. æ£€æŸ¥Nginxæ—¥å¿—ï¼š`sudo tail -f /var/log/nginx/error.log`
3. æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—ï¼š`sudo journalctl -u nginx`

---

**éƒ¨ç½²å®Œæˆæ—¶é—´**: é€šå¸¸éœ€è¦20-30åˆ†é’Ÿ  
**å»ºè®®**: é¦–æ¬¡éƒ¨ç½²å»ºè®®åœ¨æµ‹è¯•ç¯å¢ƒè¿›è¡Œ 