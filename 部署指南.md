# PARTSCONTROL é¡¹ç›®éƒ¨ç½²æŒ‡å—

## ğŸ¯ éƒ¨ç½²å‰å‡†å¤‡

### 1. æœåŠ¡å™¨ç¯å¢ƒè¦æ±‚

#### æœ€ä½é…ç½®è¦æ±‚
- **CPU**: 2æ ¸å¿ƒ
- **å†…å­˜**: 4GB RAM
- **å­˜å‚¨**: 20GB å¯ç”¨ç©ºé—´
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04+ / CentOS 7+ / Debian 10+

#### å¿…éœ€è½¯ä»¶
- **Node.js**: 16.x æˆ–æ›´é«˜ç‰ˆæœ¬
- **npm**: 8.x æˆ–æ›´é«˜ç‰ˆæœ¬
- **MySQL**: 8.0 æˆ– PostgreSQL 12+
- **Nginx**: ç”¨äºåå‘ä»£ç†
- **Git**: ç”¨äºä»£ç æ‹‰å–

### 2. åŸŸåå’ŒSSLè¯ä¹¦
- å‡†å¤‡ä¸€ä¸ªåŸŸåï¼ˆå¦‚ï¼špartcontrol.yourdomain.comï¼‰
- ç”³è¯·SSLè¯ä¹¦ï¼ˆæ¨èä½¿ç”¨Let's Encryptå…è´¹è¯ä¹¦ï¼‰

## ğŸ“‹ éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šæœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡

#### 1.1 è¿æ¥æœåŠ¡å™¨
```bash
# ä½¿ç”¨SSHè¿æ¥æ‚¨çš„æœåŠ¡å™¨
ssh root@your-server-ip
```

#### 1.2 æ›´æ–°ç³»ç»Ÿ
```bash
# Ubuntu/Debian
sudo apt update && sudo apt upgrade -y

# CentOS/RHEL
sudo yum update -y
```

#### 1.3 å®‰è£…Node.js
```bash
# æ–¹æ³•1ï¼šä½¿ç”¨NodeSourceä»“åº“ï¼ˆæ¨èï¼‰
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# éªŒè¯å®‰è£…
node --version
npm --version
```

#### 1.4 å®‰è£…MySQL
```bash
# Ubuntu/Debian
sudo apt install mysql-server -y

# å¯åŠ¨MySQLæœåŠ¡
sudo systemctl start mysql
sudo systemctl enable mysql

# å®‰å…¨é…ç½®
sudo mysql_secure_installation
```

#### 1.5 å®‰è£…Nginx
```bash
sudo apt install nginx -y
sudo systemctl start nginx
sudo systemctl enable nginx
```

#### 1.6 å®‰è£…Git
```bash
sudo apt install git -y
```

### ç¬¬äºŒæ­¥ï¼šé¡¹ç›®éƒ¨ç½²

#### 2.1 åˆ›å»ºé¡¹ç›®ç›®å½•
```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•
sudo mkdir -p /var/www/partcontrol
sudo chown $USER:$USER /var/www/partcontrol
cd /var/www/partcontrol
```

#### 2.2 ä¸Šä¼ é¡¹ç›®æ–‡ä»¶
```bash
# æ–¹æ³•1ï¼šä½¿ç”¨Gitï¼ˆæ¨èï¼‰
git clone https://github.com/your-username/PARTSCONTROL.git .

# æ–¹æ³•2ï¼šä½¿ç”¨SCPä¸Šä¼ 
# åœ¨æœ¬åœ°æ‰§è¡Œï¼š
scp -r /path/to/PARTSCONTROL root@your-server-ip:/var/www/partcontrol/
```

#### 2.3 é…ç½®ç¯å¢ƒå˜é‡
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp env.example .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env
```

#### 2.4 é…ç½®æ•°æ®åº“
```bash
# ç™»å½•MySQL
sudo mysql -u root -p

# åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·
CREATE DATABASE partcontrol CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'partcontrol'@'localhost' IDENTIFIED BY 'your-strong-password';
GRANT ALL PRIVILEGES ON partcontrol.* TO 'partcontrol'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

### ç¬¬ä¸‰æ­¥ï¼šåç«¯éƒ¨ç½²

#### 3.1 å®‰è£…åç«¯ä¾èµ–
```bash
cd /var/www/partcontrol/åç«¯
npm install
```

#### 3.2 é…ç½®åç«¯ç¯å¢ƒå˜é‡
```bash
# ç¼–è¾‘åç«¯ç¯å¢ƒå˜é‡
nano .env
```

é…ç½®å†…å®¹ç¤ºä¾‹ï¼š
```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_NAME=partcontrol
DB_USER=partcontrol
DB_PASSWORD=your-strong-password

# JWTé…ç½®
JWT_SECRET=your-super-secret-jwt-key
JWT_EXPIRES_IN=24h

# æœåŠ¡å™¨é…ç½®
PORT=3000
NODE_ENV=production

# é‚®ä»¶é…ç½®
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USER=your-email@gmail.com
MAIL_PASS=your-app-password

# æ–‡ä»¶ä¸Šä¼ é…ç½®
UPLOAD_PATH=./uploads
MAX_FILE_SIZE=10485760
```

#### 3.3 åˆ›å»ºå¿…è¦ç›®å½•
```bash
# åˆ›å»ºä¸Šä¼ ç›®å½•
mkdir -p uploads
mkdir -p logs

# è®¾ç½®æƒé™
chmod 755 uploads
chmod 755 logs
```

#### 3.4 å¯åŠ¨åç«¯æœåŠ¡
```bash
# å¼€å‘æ¨¡å¼æµ‹è¯•
npm start

# ç”Ÿäº§æ¨¡å¼ï¼ˆä½¿ç”¨PM2ï¼‰
npm install -g pm2
pm2 start server.js --name "partcontrol-backend"
pm2 save
pm2 startup
```

### ç¬¬å››æ­¥ï¼šå‰ç«¯éƒ¨ç½²

#### 4.1 å®‰è£…å‰ç«¯ä¾èµ–
```bash
cd /var/www/partcontrol/å‰ç«¯
npm install
```

#### 4.2 é…ç½®å‰ç«¯ç¯å¢ƒå˜é‡
```bash
# åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½®
nano .env.production
```

é…ç½®å†…å®¹ï¼š
```env
VITE_API_BASE_URL=https://your-domain.com/api
VITE_APP_TITLE=PARTSCONTROL
```

#### 4.3 æ„å»ºå‰ç«¯
```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# æ„å»ºå®Œæˆåï¼Œdistç›®å½•åŒ…å«é™æ€æ–‡ä»¶
```

#### 4.4 é…ç½®Nginx
```bash
# åˆ›å»ºNginxé…ç½®æ–‡ä»¶
sudo nano /etc/nginx/sites-available/partcontrol
```

é…ç½®å†…å®¹ï¼š
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /var/www/partcontrol/å‰ç«¯/dist;
        try_files $uri $uri/ /index.html;
        index index.html;
    }
    
    # åç«¯APIä»£ç†
    location /api {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
    
    # æ–‡ä»¶ä¸Šä¼ ç›®å½•
    location /uploads {
        alias /var/www/partcontrol/åç«¯/uploads;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }
}
```

#### 4.5 å¯ç”¨Nginxé…ç½®
```bash
# åˆ›å»ºè½¯é“¾æ¥
sudo ln -s /etc/nginx/sites-available/partcontrol /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯Nginx
sudo systemctl restart nginx
```

### ç¬¬äº”æ­¥ï¼šSSLè¯ä¹¦é…ç½®

#### 5.1 å®‰è£…Certbot
```bash
# Ubuntu/Debian
sudo apt install certbot python3-certbot-nginx -y
```

#### 5.2 ç”³è¯·SSLè¯ä¹¦
```bash
sudo certbot --nginx -d your-domain.com
```

#### 5.3 è‡ªåŠ¨ç»­æœŸ
```bash
# æµ‹è¯•è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run

# æ·»åŠ åˆ°crontab
sudo crontab -e
# æ·»åŠ ä»¥ä¸‹è¡Œï¼š
0 12 * * * /usr/bin/certbot renew --quiet
```

### ç¬¬å…­æ­¥ï¼šé˜²ç«å¢™é…ç½®

#### 6.1 é…ç½®UFWé˜²ç«å¢™
```bash
# å®‰è£…UFW
sudo apt install ufw -y

# è®¾ç½®é»˜è®¤ç­–ç•¥
sudo ufw default deny incoming
sudo ufw default allow outgoing

# å…è®¸SSH
sudo ufw allow ssh

# å…è®¸HTTPå’ŒHTTPS
sudo ufw allow 80
sudo ufw allow 443

# å¯ç”¨é˜²ç«å¢™
sudo ufw enable
```

### ç¬¬ä¸ƒæ­¥ï¼šç›‘æ§å’Œæ—¥å¿—

#### 7.1 é…ç½®æ—¥å¿—è½®è½¬
```bash
# åˆ›å»ºæ—¥å¿—è½®è½¬é…ç½®
sudo nano /etc/logrotate.d/partcontrol
```

é…ç½®å†…å®¹ï¼š
```
/var/www/partcontrol/åç«¯/logs/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    create 644 www-data www-data
    postrotate
        systemctl reload nginx
    endscript
}
```

#### 7.2 è®¾ç½®ç›‘æ§
```bash
# å®‰è£…htopç›‘æ§å·¥å…·
sudo apt install htop -y

# æŸ¥çœ‹ç³»ç»Ÿèµ„æº
htop
```

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### 1. ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
sudo netstat -tlnp | grep :3000

# æ€æ­»è¿›ç¨‹
sudo kill -9 <PID>
```

### 2. æƒé™é—®é¢˜
```bash
# ä¿®å¤æ–‡ä»¶æƒé™
sudo chown -R www-data:www-data /var/www/partcontrol
sudo chmod -R 755 /var/www/partcontrol
```

### 3. æ•°æ®åº“è¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥MySQLçŠ¶æ€
sudo systemctl status mysql

# é‡å¯MySQL
sudo systemctl restart mysql
```

### 4. Nginxé…ç½®é”™è¯¯
```bash
# æ£€æŸ¥Nginxé…ç½®
sudo nginx -t

# æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log
```

## ğŸ“Š éƒ¨ç½²éªŒè¯

### 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
# æ£€æŸ¥åç«¯æœåŠ¡
pm2 status

# æ£€æŸ¥NginxæœåŠ¡
sudo systemctl status nginx

# æ£€æŸ¥MySQLæœåŠ¡
sudo systemctl status mysql
```

### 2. æµ‹è¯•APIæ¥å£
```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥æ¥å£
curl http://localhost:3000/api/health

# æµ‹è¯•å‰ç«¯è®¿é—®
curl -I http://your-domain.com
```

### 3. æ£€æŸ¥SSLè¯ä¹¦
```bash
# æ£€æŸ¥SSLè¯ä¹¦çŠ¶æ€
sudo certbot certificates
```

## ğŸš€ è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬

### ä½¿ç”¨æä¾›çš„éƒ¨ç½²è„šæœ¬
```bash
# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x deploy.sh

# è¿è¡Œéƒ¨ç½²è„šæœ¬
./deploy.sh
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æœåŠ¡å™¨æ—¥å¿—ï¼š`/var/log/nginx/error.log`
2. åº”ç”¨æ—¥å¿—ï¼š`/var/www/partcontrol/åç«¯/logs/`
3. PM2æ—¥å¿—ï¼š`pm2 logs`

## ğŸ”’ å®‰å…¨å»ºè®®

1. **å®šæœŸæ›´æ–°ç³»ç»Ÿ**ï¼š`sudo apt update && sudo apt upgrade`
2. **å¤‡ä»½æ•°æ®åº“**ï¼šè®¾ç½®è‡ªåŠ¨å¤‡ä»½è„šæœ¬
3. **ç›‘æ§èµ„æº**ï¼šä½¿ç”¨htopæˆ–ç±»ä¼¼å·¥å…·
4. **æ—¥å¿—ç›‘æ§**ï¼šå®šæœŸæ£€æŸ¥é”™è¯¯æ—¥å¿—
5. **SSLè¯ä¹¦**ï¼šç¡®ä¿è¯ä¹¦è‡ªåŠ¨ç»­æœŸ

---

**éƒ¨ç½²å®Œæˆæ—¶é—´**: æ ¹æ®æœåŠ¡å™¨é…ç½®ï¼Œé€šå¸¸éœ€è¦30-60åˆ†é’Ÿ  
**å»ºè®®**: é¦–æ¬¡éƒ¨ç½²å»ºè®®åœ¨æµ‹è¯•ç¯å¢ƒè¿›è¡Œ 